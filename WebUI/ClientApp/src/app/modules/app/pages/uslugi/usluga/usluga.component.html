<p-card header="Dodanie nowej usługi">
    <form [formGroup]="nowaUslugaForm">
        <div class="p-fluid p-formgrid p-grid">
            <div class="p-field p-col-2">
                <label for="dataPrzyjeciaZalecenia">Data przyjęcia zlecenia</label>
                <p-calendar formControlName="dataPrzyjeciaZalecenia" [showIcon]="true" [locale]="pl" [dateFormat]="null" inputId="dataPrzyjeciaZalecenia">
                </p-calendar>
            </div>
            <div class="p-field p-col-4">
                <label for="klient">Klient</label>
                <p-dropdown formControlName="klient" id="klient" [options]="klienci" [filter]="true" [autoDisplayFirst]="false" required filterBy="label"
                    placeholder="Wybierz klienta" emptyFilterMessage="Brak wyników.">
                </p-dropdown>
            </div>
        </div>
    </form>
    <h2>Misje</h2>
    <p-table [value]="misje" [(contextMenuSelection)]="wybranaMisja" [contextMenu]="contextMenuRef">
        <ng-template pTemplate="header">
            <tr>
                <th pSortableColumn="nazwa">Nazwa<p-sortIcon field="nazwa"></p-sortIcon>
                </th>
                <th pSortableColumn="typ.nazwa">Typ<p-sortIcon field="typ.nazwa"></p-sortIcon>
                </th>
                <th pSortableColumn="maksymalnaWysokoscLotu">Maksymalna wysokość lotu<p-sortIcon field="maksymalnaWysokoscLotu"></p-sortIcon>
                </th>
                <th pSortableColumn="dataRozpoczecia">Data rozpoczęcia<p-sortIcon field="dataRozpoczecia"></p-sortIcon>
                </th>
                <th pSortableColumn="dataZakonczenia">Data zakończenia<p-sortIcon field="dataZakonczenia"></p-sortIcon>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-misja let-rowIndex="rowIndex">
            <tr [pContextMenuRow]="misja" [pContextMenuRowIndex]="rowIndex">
                <td>{{misja.nazwa}}</td>
                <td>{{misja.typ.nazwa}}</td>
                <td>{{misja.maksymalnaWysokoscLotu}} m</td>
                <td>{{misja.dataRozpoczecia | dateFormat: 'llll'}}</td>
                <td>{{misja.dataZakonczenia ? (misja.dataZakonczenia | dateFormat: 'llll') : 'nd.'}}</td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
            <tr>
                <td [attr.colspan]="5">
                    Brak misji
                </td>
            </tr>
        </ng-template>
    </p-table>
    <p-contextMenu #contextMenuRef [model]="kontekstoweMenu"></p-contextMenu>
    <button pButton type="button" icon="pi pi-star-o" class="p-mt-3" label="Dodaj misje" (click)="dodajMisjeOnClick()"></button>
    <div class="p-d-flex p-jc-end">
        <div>
            <button pButton type="button" icon="pi pi-check" class="p-mt-3" label="Zapisz usługę" [disabled]="nowaUslugaForm.invalid" (click)="zapiszUsluge()"></button>
        </div>
    </div>
</p-card>